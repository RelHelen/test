<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .form_book {
            width: 300px;
            margin: 2rem;
        }
        
        input,
        textarea {
            width: 100%;
            margin: 10px 0;
        }
        
        .list {
            width: 300px;
        }
        
        .block {
            margin: 10px 0;
            border-bottom: 1px solid grey;
            position: relative;
        }
        
        .block p {
            margin: 0;
        }
        
        .remove-button {
            content: '[x]';
            display: inline-block;
            position: absolute;
            font-size: 110%;
            top: 0;
            background: #000;
            right: 10px;
            display: block;
            width: 24px;
            height: 24px;
            border: none;
            /* background: transparent; */
            cursor: pointer;
        }
        
        .select {
            background-color: rgba(127, 255, 212, 0.43);
        }
    </style>
</head>

<body>
    <div class="row">
        <div class="col-6">
            <form class="form_book" id="form" action="">
                <!-- Email input -->
                <div class="form-outline">
                    <label for="text" class="form-label">Введите имя; </label>
                    <input type="text" class="form-control" name="text" id="text" placeholder="name" /><br />
                </div>


                <div class="form-outline">
                    <label for="text" class="form-label">Введите задание: </label>
                    <textarea class="form-control" name="desc" id="desc" cols="30" rows="10"></textarea><br />
                </div>

                <div class="form-outline">
                    <label for="elDate" class="form-label">Укажите сроки: </label>
                    <input type="datetime-local" id="elDate" name="date" class="form-control" />

                </div>


                <input type="button" class="form-control list__add" name="submit" id="submit" value="Добавить" />
            </form>
        </div>
        <div class="col-6">
            <div class="list" id="list"></div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js " integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE " crossorigin="anonymous "></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js " integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ " crossorigin="anonymous "></script>
    <script>
        const listOb = {
            createMyElement(tag, attribute) {
                const element = document.createElement(tag);
                //копирует в текущий объект  из исходного объекта перечисляемые свойства
                Object.assign(element, attribute);
                //   console.log(' Object.assign(element, attribute): ', element);
                return element;
            },
            creatLi() {
                // let Data = new Date();
                const elBlock = this.createMyElement('div', {
                    classList: 'block',
                });
                //создали заголовок 
                const elH = this.createMyElement('p', {
                    classList: 'nameLi',
                    innerText: "name: " + text.value,
                });
                //создали параграф
                const elP = this.createMyElement('p', {
                    classList: 'noteLi',
                    textContent: "note: " + desc.value,
                });
                //создали дату

                const elSpanD = this.createMyElement('p', {
                    textContent: "date begin: " + new Date().toLocaleString().slice(0, -3),
                    classList: 'dateN'
                });
                const date = JSON.stringify({
                    add: new Date().toLocaleString().slice(0, -3)
                });
                const elSpan = this.createMyElement('p', {
                    textContent: "date completed: " + elDate.value,
                    classList: 'dateComplited'
                });

                const elBtn = this.createMyElement('span', {
                    classList: 'remove-button'
                });
                elBlock.append(elH, elP, elSpanD, elSpan, elBtn);
                list.append(elBlock);
                //очистили
                text.value = '';
                desc.value = '';
                elDate.value = '';
            },
            addList() {
                this.creatLi();
                const divs = document.querySelectorAll('.block');
                const data = [];
                console.log(divs);

                for (let div of divs) {
                    const divsChild = div.children;
                    data.push({
                        nameLi: divsChild[0].textContent,
                        noteLi: divsChild[1].textContent,
                        dateN: divsChild[2].textContent,
                        dateComplited: divsChild[3].textContent,
                    })
                }
                this.save(data);
            },
            remove(e) {
                const removeButtons = list.querySelectorAll('.remove-button');
                const divs = document.querySelectorAll('.block ');
                for (removeButton of removeButtons) {
                    if (e.target == removeButton) {
                        let parent = removeButton.closest('.block');
                        parent.classList.toggle('select');
                    }
                }
            },
            save(data) {
                localStorage.setItem('list', JSON.stringify(data));
            },
            init() {


                submit.addEventListener('click', this.addList.bind(this));
                list.addEventListener('click', this.remove);
            }
        };
        listOb.init();
    </script>
</body>

</html>